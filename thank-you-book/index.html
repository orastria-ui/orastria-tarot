<!DOCTYPE html>
<html lang="en">
<head>
<!-- Meta Pixel Code - Deferred until purchase verification -->
<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ORASTRIA THANK YOU PAGE - PURCHASE TRACKING
// v2026-02-24-v5: Fixed event_id for Meta CAPI deduplication
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const SUPABASE_URL = 'https://bkxgpjxfexndjwawaiph.supabase.co';
const SUPABASE_KEY = 'sb_publishable_qw9JxZ0SwYY5s_yOOylcgg_BWF2FnQ7';
const KLAVIYO_WORKER = 'https://orastria-api.orastria.workers.dev/klaviyo/purchase';
const SESSION_RESOLVER = 'https://orastria-api.orastria.workers.dev/session-to-uid';
const PIXEL_ID = '1196585509341329';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PERSONALIZATION - Called when we have user data
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function personalizePage(userData) {
  const params = new URLSearchParams(window.location.search);
  const name = params.get('name') || (userData ? userData.first_name : '') || localStorage.getItem('orastria_name') || '';

  if (name) {
    const firstName = name.split(' ')[0];
    const nameEl = document.getElementById('ty2-name');
    const coverEl = document.getElementById('ty2-cover-name');
    if (nameEl) nameEl.textContent = firstName;
    if (coverEl) coverEl.textContent = firstName;
    console.log('‚úì Page personalized for:', firstName);
  } else {
    console.log('‚úì Page personalized for: friend (no name found)');
  }
  
  // Store for other scripts
  window.thankYouUserData = userData;
}

// SHA256 hash function for email
async function sha256(message) {
  const msgBuffer = new TextEncoder().encode(message);
  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
}

// Generate deterministic event_id for deduplication (same as server-side CAPI)
function generateEventId(uid) {
  return `purchase_${uid}`;  // Must match server-side for dedup
}

// Get user IP
async function getUserIP() {
  try {
    const res = await fetch('https://api.ipify.org?format=json');
    const data = await res.json();
    return data.ip;
  } catch (e) {
    console.warn('Could not fetch IP:', e);
    return null;
  }
}

// Initialize Meta Pixel
function initPixel(advancedMatching = {}) {
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');

  fbq('init', PIXEL_ID, advancedMatching);
  fbq('track', 'PageView');
  console.log('üìä Pixel initialized');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// Resolve UID - handles both real UUIDs and Stripe session IDs
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function resolveUID(rawUID) {
  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
  if (rawUID && uuidRegex.test(rawUID)) {
    console.log('‚úì UID is a valid UUID:', rawUID);
    return { uid: rawUID, email: null };
  }

  if (rawUID && rawUID.startsWith('cs_')) {
    console.log('‚ö†Ô∏è UID is a Stripe session ID, resolving via API...');
    try {
      const response = await fetch(`${SESSION_RESOLVER}?session_id=${rawUID}`);
      if (response.ok) {
        const data = await response.json();
        if (data.uid) {
          console.log('‚úì Resolved real UID from session:', data.uid);
          return { uid: data.uid, email: data.email };
        }
      }
      console.error('‚ùå Could not resolve session to UID');
    } catch (error) {
      console.error('‚ùå Session resolution failed:', error);
    }
  }

  return { uid: null, email: null };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MAIN PURCHASE FLOW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(async function processPurchase() {
  const urlParams = new URLSearchParams(window.location.search);
  let rawUID = urlParams.get('uid');
  const sessionId = urlParams.get('session_id');
  
  console.log('‚îÅ‚îÅ‚îÅ THANK YOU PAGE LOADED ‚îÅ‚îÅ‚îÅ');
  console.log('Raw UID from URL:', rawUID);
  console.log('Session ID:', sessionId);

  // STEP 0: Resolve UID if it's a Stripe session ID
  let uid = rawUID;
  
  if (!rawUID && sessionId && sessionId.startsWith('cs_')) {
    console.log('üìç No UID, but have session_id - attempting resolution...');
    const resolved = await resolveUID(sessionId);
    uid = resolved.uid;
  } else if (rawUID && rawUID.startsWith('cs_')) {
    const resolved = await resolveUID(rawUID);
    uid = resolved.uid;
  } else if (rawUID) {
    const resolved = await resolveUID(rawUID);
    uid = resolved.uid;
  }

  // STEP 1: Verify UID exists
  if (!uid) {
    console.error('‚ùå Could not determine user ID');
    initPixel();
    personalizePage(null); // Still personalize with fallback
    return;
  }
  
  console.log('‚úÖ Using resolved UID:', uid);

  // STEP 2: Fetch user from Supabase
  console.log('üìä Fetching user from Supabase...');
  
  let userData;
  try {
    const response = await fetch(
      `${SUPABASE_URL}/rest/v1/orastria_submissions?id=eq.${uid}&select=*`,
      {
        headers: {
          'apikey': SUPABASE_KEY,
          'Authorization': `Bearer ${SUPABASE_KEY}`
        }
      }
    );
    
    const users = await response.json();
    
    if (!users || users.length === 0) {
      console.error('‚ùå User not found in database for UID:', uid);
      initPixel();
      personalizePage(null);
      return;
    }
    
    userData = users[0];
    console.log('‚úÖ User found:', userData.email, '| Name:', userData.first_name);
    
  } catch (error) {
    console.error('‚ùå Supabase fetch error:', error);
    initPixel();
    personalizePage(null);
    return;
  }

  // *** PERSONALIZE PAGE IMMEDIATELY AFTER GETTING USER DATA ***
  personalizePage(userData);

  // STEP 3: Check if already purchased
  if (userData.buy === true || userData.buy === 'yes' || userData.buy === 'true') {
    console.log('‚ö†Ô∏è User already purchased - NOT firing Purchase event again');
    initPixel();
    return;
  }

  // STEP 4: NEW PURCHASE - Fire events
  console.log('üéâ NEW PURCHASE DETECTED');
  
  const userIP = await getUserIP();
  const userAgent = navigator.userAgent;
  const fbclid = userData.fbclid || urlParams.get('fbclid') || '';
  const eventId = generateEventId(uid);
  
  const advancedMatching = { external_id: uid };
  
  if (fbclid) {
    advancedMatching.fbc = 'fb.1.' + Date.now() + '.' + fbclid;
  }
  if (userData.email) {
    advancedMatching.em = await sha256(userData.email.toLowerCase().trim());
  }
  if (userIP) {
    advancedMatching.client_ip_address = userIP;
  }
  if (userAgent) {
    advancedMatching.client_user_agent = userAgent;
  }
  
  console.log('üìä Event ID:', eventId);
  
  initPixel(advancedMatching);
  
  fbq('track', 'Purchase', {
    value: 7.99,
    currency: 'EUR',
    content_name: 'Orastria Full Book',
    content_type: 'product',
    content_ids: ['orastria-book'],
    order_id: uid
  }, { eventID: eventId });
  
  console.log('‚úÖ Meta Purchase event fired: ‚Ç¨7.99');

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // GOOGLE ADS CONVERSION (with Enhanced Conversions)
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  if (typeof gtag === 'function') {
    // Set user_data for Enhanced Conversions
    gtag('set', 'user_data', {
      'email': userData.email || '',
      'first_name': userData.first_name || '',
      'last_name': userData.last_name || ''
    });
    
    // Fire conversion event
    gtag('event', 'conversion', {
      'send_to': 'AW-17514821837/88zjCM_ng_4bEM3x259B',
      'value': 7.99,
      'currency': 'EUR',
      'transaction_id': uid
    });
    
    console.log('‚úÖ Google Ads conversion fired: ‚Ç¨7.99');
  } else {
    console.warn('‚ö†Ô∏è gtag not loaded - Google Ads conversion skipped');
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // MICROSOFT/BING ADS CONVERSION
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  window.uetq = window.uetq || [];
  window.uetq.push('event', 'purchase', {
    'revenue_value': 7.99,
    'currency': 'EUR',
    'transaction_id': uid
  });
  console.log('‚úÖ Bing Ads conversion fired: ‚Ç¨7.99');

  // STEP 5: Update Supabase + Klaviyo (fire and forget)
  console.log('üìù Updating Supabase and Klaviyo...');
  
  fetch(`${SUPABASE_URL}/rest/v1/orastria_submissions?id=eq.${uid}`, {
    method: 'PATCH',
    headers: {
      'Content-Type': 'application/json',
      'apikey': SUPABASE_KEY,
      'Authorization': `Bearer ${SUPABASE_KEY}`,
      'Prefer': 'return=minimal'
    },
    body: JSON.stringify({ buy: true })
  }).then(r => console.log(r.ok ? '‚úÖ Supabase: buy=true' : '‚ùå Supabase failed'))
    .catch(e => console.error('‚ùå Supabase error:', e));
  
  // Klaviyo Worker temporarily disabled (ERR_CONNECTION_CLOSED)
  // fetch(KLAVIYO_WORKER, {
  //   method: 'POST',
  //   headers: { 'Content-Type': 'application/json' },
  //   body: JSON.stringify({ email: userData.email })
  // }).then(r => r.json())
  //   .then(d => console.log(d.success ? '‚úÖ Klaviyo: pay?=yes' : '‚ùå Klaviyo failed:', d))
  //   .catch(e => console.error('‚ùå Klaviyo error:', e));
  
  console.log('‚îÅ‚îÅ‚îÅ PURCHASE TRACKING COMPLETE ‚îÅ‚îÅ‚îÅ');
})();
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1196585509341329&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
<!-- Google Ads (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-17514821837"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'AW-17514821837');
</script>
<!-- End Google Ads -->
<!-- Microsoft/Bing UET Tag -->
<script>(function(w,d,t,u,o){w[u]=w[u]||[],o.ts=(new Date).getTime();var n=d.createElement(t);n.src="https://bat.bing.net/bat.js?ti="+o.ti+("uetq"!=u?"&q="+u:""),n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&"loaded"!==s&&"complete"!==s||(o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad"),n.onload=n.onreadystatechange=null)};var i=d.getElementsByTagName(t)[0];i.parentNode.insertBefore(n,i)})(window,document,"script","uetq",{ti:"187237886",enableAutoSpaTracking:true});</script>
<!-- End Bing UET -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orastria ‚Äî Your Book is Being Prepared ‚ú®</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="thank-you.css" />
</head>
<body>

<!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<header class="ty2-header">
  <img src="../book-1/assets/images/logo.avif" alt="Orastria" class="ty2-logo" />
</header>

<!-- ‚îÄ‚îÄ HERO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section class="ty2-hero">
  <div class="ty2-check-wrap">
    <svg class="ty2-check-svg" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="32" cy="32" r="30" stroke="#c9a227" stroke-width="2" stroke-opacity="0.3"/>
      <circle cx="32" cy="32" r="30" stroke="#c9a227" stroke-width="2" stroke-dasharray="188.5" stroke-dashoffset="188.5" class="ty2-check-ring"/>
      <polyline points="18,33 27,43 46,22" stroke="#c9a227" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="42" stroke-dashoffset="42" class="ty2-check-tick"/>
    </svg>
    <div class="ty2-check-glow"></div>
  </div>

  <h1 class="ty2-title">Payment confirmed,<br><em id="ty2-name">friend</em>. ‚ú®</h1>
  <p class="ty2-sub">Your complete personalised astrology book is being prepared right now. You'll receive it by email within a few minutes.</p>

  <div class="ty2-email-badge">
    <span class="ty2-email-icon">üì¨</span>
    Check your inbox ‚Äî it's on its way
  </div>
</section>

<!-- ‚îÄ‚îÄ WHAT HAPPENS NEXT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section class="ty2-steps-section">
  <h2 class="ty2-steps-title">What happens next</h2>
  <div class="ty2-steps">
    <div class="ty2-step">
      <div class="ty2-step-num">1</div>
      <div class="ty2-step-body">
        <strong>We generate your book</strong>
        <span>Your 137-page reading is being personalised around your exact birth chart right now.</span>
      </div>
    </div>
    <div class="ty2-step-divider"></div>
    <div class="ty2-step">
      <div class="ty2-step-num">2</div>
      <div class="ty2-step-body">
        <strong>You receive it by email</strong>
        <span>A download link lands in your inbox within a few minutes. Check your spam folder if you don't see it.</span>
      </div>
    </div>
    <div class="ty2-step-divider"></div>
    <div class="ty2-step">
      <div class="ty2-step-num">3</div>
      <div class="ty2-step-body">
        <strong>Read it at your own pace</strong>
        <span>Your book is yours forever ‚Äî save it, print it, revisit it whenever you need guidance.</span>
      </div>
    </div>
  </div>
</section>

<!-- ‚îÄ‚îÄ BOOK PREVIEW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section class="ty2-book-section">
  <p class="ty2-book-label">A glimpse of what's inside</p>
  <div class="ty2-book-wrap">
    <div class="ty2-book-float">
      <svg class="ty2-book-svg" viewBox="0 0 180 240" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="10" y="5" width="160" height="230" rx="4" fill="#1a1a2e"/>
        <rect x="10" y="5" width="160" height="230" rx="4" stroke="#c9a227" stroke-width="2"/>
        <rect x="22" y="17" width="136" height="206" rx="2" stroke="#c9a227" stroke-width="0.8" stroke-opacity="0.4"/>
        <rect x="22" y="24" width="136" height="26" rx="2" fill="#c9a227" fill-opacity="0.1"/>
        <rect x="22" y="24" width="136" height="26" rx="2" stroke="#c9a227" stroke-width="0.6" stroke-opacity="0.5"/>
        <text x="90" y="41" text-anchor="middle" fill="#c9a227" font-family="Georgia, serif" font-size="12" font-weight="bold" letter-spacing="0.5" id="ty2-cover-name">Your Name</text>
        <text x="90" y="58" text-anchor="middle" fill="#c9a227" font-family="Georgia, serif" font-size="6.5" fill-opacity="0.75" letter-spacing="2">BIRTH CHART READING</text>
        <circle cx="90" cy="128" r="54" stroke="#c9a227" stroke-width="0.9" stroke-opacity="0.65"/>
        <circle cx="90" cy="128" r="39" stroke="#6b5b95" stroke-width="0.9" stroke-opacity="0.75"/>
        <circle cx="90" cy="128" r="24" stroke="#c9a227" stroke-width="0.9" stroke-opacity="0.65"/>
        <circle cx="90" cy="128" r="8" fill="#c9a227" fill-opacity="0.12" stroke="#c9a227" stroke-width="0.9"/>
        <line x1="90" y1="74" x2="90" y2="62" stroke="#c9a227" stroke-width="0.8" stroke-opacity="0.5"/>
        <line x1="90" y1="182" x2="90" y2="194" stroke="#c9a227" stroke-width="0.8" stroke-opacity="0.5"/>
        <line x1="36" y1="128" x2="24" y2="128" stroke="#c9a227" stroke-width="0.8" stroke-opacity="0.5"/>
        <line x1="144" y1="128" x2="156" y2="128" stroke="#c9a227" stroke-width="0.8" stroke-opacity="0.5"/>
        <circle cx="90" cy="89" r="4" fill="#c9a227"/>
        <circle cx="117" cy="103" r="3" fill="#c9a227" fill-opacity="0.7"/>
        <circle cx="144" cy="128" r="4" fill="#6b5b95"/>
        <circle cx="68" cy="160" r="3" fill="#c9a227" fill-opacity="0.5"/>
        <g transform="translate(82, 193) scale(0.8)" fill="none" stroke="#c9a227" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 8 C3 5 6 3 10 3 C14 3 17 5 17 8 C17 11 14 13 10 13 C6 13 3 11 3 8 M10 13 L10 19 M7 19 L13 19"/>
        </g>
        <text x="90" y="216" text-anchor="middle" fill="#c9a227" font-family="Georgia, serif" font-size="6.5" fill-opacity="0.7">Jan 1, 1990</text>
        <rect x="5" y="5" width="7" height="230" rx="1" fill="#0f0f1a"/>
        <text x="9" y="155" text-anchor="middle" fill="#c9a227" font-family="Georgia, serif" font-size="6" fill-opacity="0.5" letter-spacing="2" transform="rotate(-90, 9, 120)">ORASTRIA</text>
      </svg>
      <div class="ty2-book-glow"></div>
    </div>
    <div class="ty2-chapters">
      <p class="ty2-chapters-label">Your book includes</p>
      <ul class="ty2-chapters-list">
        <li><span class="ty2-ch-num">01</span><span>Your Sun, Moon & Rising ‚Äî who you truly are</span></li>
        <li><span class="ty2-ch-num">02</span><span>Love & relationships ‚Äî your compatibility map</span></li>
        <li><span class="ty2-ch-num">03</span><span>Life path & soul purpose</span></li>
        <li><span class="ty2-ch-num">04</span><span>Career, money & timing windows</span></li>
        <li><span class="ty2-ch-num">05</span><span>2025‚Äì2026 predictions & key dates</span></li>
        <li><span class="ty2-ch-num">06</span><span>Shadow work & spiritual growth</span></li>
        <li><span class="ty2-ch-num">07</span><span>Tarot & numerology profile</span></li>
        <li class="ty2-ch-more">+ much more across 137 pages</li>
      </ul>
    </div>
  </div>
</section>

<!-- ‚îÄ‚îÄ GUARANTEE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section class="ty2-guarantee-section">
  <div class="ty2-guarantee-card">
    <div class="ty2-guarantee-icon">üõ°Ô∏è</div>
    <div>
      <strong>30-Day Money-Back Guarantee</strong>
      <p>If you're not completely satisfied with your book, email us within 30 days and we'll refund you in full ‚Äî no questions asked.</p>
    </div>
  </div>
</section>

<!-- ‚îÄ‚îÄ SHARE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section class="ty2-share-section">
  <p class="ty2-share-label">Know someone who would love this?</p>
  <div class="ty2-share-btns">
    <button class="ty2-share-btn ty2-share-wa" onclick="shareWhatsApp()">
      <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.122.554 4.118 1.523 5.853L0 24l6.343-1.501A11.933 11.933 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 21.818a9.817 9.817 0 01-5.002-1.368l-.358-.213-3.766.892.938-3.669-.234-.374A9.787 9.787 0 012.182 12C2.182 6.57 6.57 2.182 12 2.182c5.43 0 9.818 4.388 9.818 9.818 0 5.43-4.388 9.818-9.818 9.818z"/></svg>
      Share on WhatsApp
    </button>
    <button class="ty2-share-btn ty2-share-copy" onclick="copyLink()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
      <span id="ty2-copy-label">Copy link</span>
    </button>
  </div>
</section>

<!-- ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<footer class="ty2-footer">
  <img src="../book-1/assets/images/logo.avif" alt="Orastria" class="ty2-footer-logo" />
  <p>Questions? Email us at <a href="mailto:hello@orastria.com">hello@orastria.com</a></p>
  <p class="ty2-footer-small">¬© 2025 Orastria ¬∑ All rights reserved</p>
</footer>

<script>
// ‚îÄ‚îÄ Animated checkmark on load ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window.addEventListener('load', () => {
  setTimeout(() => {
    document.querySelector('.ty2-check-ring').classList.add('animate');
    setTimeout(() => {
      document.querySelector('.ty2-check-tick').classList.add('animate');
    }, 500);
  }, 300);
});

// ‚îÄ‚îÄ Share helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function shareWhatsApp() {
  const text = encodeURIComponent('I just got my personalised astrology book from Orastria ‚Äî it\'s incredible! Check it out: https://orastria.com');
  window.open('https://wa.me/?text=' + text, '_blank');
}

function copyLink() {
  navigator.clipboard.writeText('https://orastria.com').then(() => {
    const label = document.getElementById('ty2-copy-label');
    label.textContent = 'Copied! ‚úì';
    setTimeout(() => label.textContent = 'Copy link', 2500);
  });
}
</script>

<script src="supabase-integration.js"></script>

</body>
</html>
